<!DOCTYPE html>
<html>  
  <head>  
        <meta charset="utf-8">  
        <title>原力-引力和斥力 d3.v4</title>  
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <script src="js/d3.v4.min.js" charset="utf-8"></script>  
  </head> 
    <body>  
        <script>

        var width = 1000,
                height = 600;

        var svg = d3.select("body")
                      .append("svg")
                      .attr("width",width)
                          .attr("height",height);

        // var nodeData = [{'x':225,'y':100,'id':'First'}];
        var nodeData = [    {'x': 100,'y':100,'r':10},
                            {'x': 300,'y':100,'r':10},
                            {'x':50,   'y':200,'r':10},
                            {'x':350,'y':200,'r':10},
                            {'x':100,'y':300,'r':10},
                            {'x':300,'y':300,'r':10}];
        var attractForce = d3.forceManyBody().strength(200);
        // .distanceMax(400).distanceMin(60)
        var repelForce = d3.forceManyBody().strength(-100);
        // .distanceMax(50).distanceMin(10)
        var collisionForce = d3.forceCollide(12).strength(1).iterations(100);
        var simulation = d3.forceSimulation(nodeData).alphaDecay(0.01)
            .force("attractForce",attractForce)
            .force("repelForce",repelForce)
            .force("collisionForce",collisionForce)
            .velocityDecay(0.4); 
   
        simulation.force("center",d3.forceCenter(width/2,height/2));
         var node = svg.selectAll("circle").data(nodeData)
                    .enter().append("circle")
                    .attr("r",function(d){ return d.r;})
                    .attr("cx",function(d){ return d.x;})
                    .attr("cy",function(d){ return d.y;})
                    .attr("fill","black").attr("opacity",0.5)
                    .call(
                        d3.drag()
                        .on("start",dragstarted)
                        .on("drag",dragged)
                        .on("end",dragended)
                    );
         
         function dragstarted(d){
            simulation.restart();
            simulation.alpha(1.0);
            d.fx = d.x;
            d.fy = d.y;
         }

         function dragged(d) {
            d.fx = d3.event.x;
            d.fy = d3.event.y;
         }

         function dragended(d){
            d.fx = null;
            d.fy = null;
            simulation.alphaTarget(0.1);
         }

         function ticked(){
             node.attr("cx", function(d){ return d.x;})
                     .attr("cy", function(d){ return d.y;})
         }

         simulation.on("tick",ticked);
          
        </script>  
        
    </body>  
</html>  